---
# Preamble

## Author
author:
  name: Верниковская E. A., НПИбд-01-23
  degrees: Student
  email: 11322361366@pfur.ru
  affiliation:
    - name: Российский университет дружбы народов
      country: Российская Федерация
      postal-code: 117198
      city: Москва
      address: ул. Миклухо-Маклая, д. 6

## Title
title: Доклад
subtitle: NFS3 и NFS4. Сравнение
license: CC BY
date: 2025-11-15

## Generic options
lang: ru-RU
crossref:
  lof-title: Список иллюстраций
  lot-title: Список таблиц
  lol-title: Листинги

## Fonts 
mainfont: PT Serif 
romanfont: PT Serif 
sansfont: PT Sans 
monofont: PT Mono 
mainfontoptions: Ligatures=TeX 
romanfontoptions: Ligatures=TeX 
sansfontoptions: Ligatures=TeX,Scale=MatchLowercase 
monofontoptions: Scale=MatchLowercase,Scale=0.9

## Formats
format:
### Pdf output format
  beamer:
    toc: true
    toc-title: Содержание
    number-sections: true
    colorlinks: false
    toc-depth: 2
    slide_level: 2
    aspectratio: 169
    section-titles: true
    theme: metropolis
    themeoptions: progressbar=frametitle,sectionpage=progressbar,numbering=fraction
    pdf-engine: xelatex
    fontenc: T2A
#### Language
    babel-lang: russian
    babel-otherlangs: english

### Html output
  revealjs:
    transition: slide
    margin: 0.2
    smaller: false
    output-ext: html
    theme: beige
    logo: _resources/image/logo_rudn.png
---

## Докладчик

:::::::::::::: {.columns align=center}
::: {.column width="70%"}

  * Верниковская Екатерина Андреевна
  * Студентка
  * Российский университет дружбы народов
  * [1132236136@pfur.ru](mailto:1132236136@pfur.ru)

:::
::: {.column width="30%"}

![](image/me.jpg)

:::
::::::::::::::

# Вводная часть

## Вводная часть 

:::::::::::::: {.columns align=top}
::: {.column width="60%"}
**Актуальность темы и проблема:**
  
  
  повсеместное использование сетевых файловых систем сталкивается с проблемой выбора между проверенным, но устаревающим NFSv3 и современным, но более сложным NFSv4, что требует четкого понимания их различий для построения эффективной и безопасной IT-инфраструктуры
  
:::
::: {.column width="30%"}
**Объект и предмет исследования:**
  
  
  сетевые файловые системы (Network File System — NFS) v3 и v4 
  
:::
::::::::::::::

## Вводная часть 

:::::::::::::: {.columns align=top}
::: {.column width="30%"}
**Цель:**
  
  
  цель данного доклада – рассмотреть основные принципы протоколов NFSv3 и NFSv4 и провести сравнительный анализ для выявления их ключевых различий и определения оптимальных сценариев использования
  
:::
::: {.column width="30%"}
**Задачи исследования:**
  
  
  изучить архитектурные особенности NFSv3 и NFSv4, провести их сравнительный анализ по ключевым параметрам и сформулировать практические рекомендации по выбору протокола
  
:::
::: {.column width="20%"}
**Материалы и методы и инструменты исследования:**
  
  
  интернет-ресурсы, аналитика и практические навыки работы на своей операционной системе Linux (Ubuntu)
:::
::::::::::::::

## Введение

:::::::::::::: {.columns align=top}
::: {.column width="70%"}

В процессе своей работы сетевая инфраструктура постоянно обеспечивает доступ к данным, и выбор технологии для этого является фундаментальным для производительности и безопасности. Сетевая файловая система (NFS) долгие годы остаётся основным решением для организации разделяемого доступа к файлам в UNIX- и Linux-средах. Однако со временем перед администраторами встаёт вопрос выбора между проверенной, но устаревающей третьей версией протокола и современной, но более сложной четвёртой. Понимание ключевых различий между NFSv3 и NFSv4 — критически важная задача для любого системного администратора

:::
::: {.column width="30%"}

![](image/nfs2.png)

:::
::::::::::::::

## Что такое NFS?

:::::::::::::: {.columns align=top}
::: {.column width="50%"}

![](image/nfs.png)

:::
::: {.column width="50%"}

**NFS(Network File System)** – это сетевая файловая система, позволяющая пользователям обращаться к файлам и каталогам, расположенным на удалённых компьютерах, как если бы эти файлы и каталоги были локальными. NFS – это клиент-серверное приложение. Т.е. в системе пользователя должен быть установлен NFS-клиент, а на компьютерах, которые предоставляют свое дисковое пространство – NFS-сервер.

:::
::::::::::::::

## История и развитие NFS

:::::::::::::: {.columns align=top}
::: {.column width="50%"}

Протокол NFS (Network File System) был разработан компанией **Sun Microsystems** в 1984 году и стал одним из первых успешных решений для организации сетевого доступа к файлам. Первая версия применялась только для внутреннего использования Sun в эксперементальных целях.

:::
::: {.column width="50%"}

![](image/sun.png)

:::
::::::::::::::

## История и развитие NFS

:::::::::::::: {.columns align=top}
::: {.column width="30%"}

![](image/nfs_history.png){width="90%"}

:::
::: {.column width="70%"}

- Первая публичная версия **NFSv2** появилась в 1989 году
- Выпуск **NFSv3** в 1995 году. "Золотой стандарт"
- Кардинальные изменения произошли с появлением **NFSv4** в 2000 году
- Дальнейшее развитие продолжилось в версиях **NFSv4.1** (2010) и **NFSv4.2** (2016)

:::
::::::::::::::

# Архитектура и работа NFS

## Архитектура и работа NFS

:::::::::::::: {.columns align=top}
::: {.column width="50%"}

Принцип работы:

1. Клиент инициирует запрос на монтирование удаленной файловой системы
2. Сервер аутентифицирует запрос и предоставляет доступ к экспортируемому каталогу
3. Клиент создает точку монтирования в локальном файловом дереве
4. Приложения работают с файлами через стандартные системные вызовы

:::
::: {.column width="50%"}

![](image/nfs_work.png){width="110%"}

5. NFS-клиент преобразует локальные запросы в RPC-вызовы к серверу
6. Сервер выполняет операции и возвращает результаты клиенту

:::
::::::::::::::

## Архитектура и работа NFS

:::::::::::::: {.columns align=top}
::: {.column width="50%"}

![](image/nfs_arch.png){width="110%"}

:::
::: {.column width="50%"}

Основные компоненты архитектуры:

- NFS-сервер — экспортирует файловые системы
- NFS-клиент — монтирует удаленные ресурсы
- RPC-механизм — обеспечивает передачу запросов
- Демоны управления (mountd, statd, lockd) — дополнительные службы для NFSv3

:::
::::::::::::::

# Протокол NFSv3

## Протокол NFSv3

**NFSv3 (Network File System version 3),** выпущенный в 1995 году, представляет собой значительное улучшение по сравнению с NFSv2 и долгое время являлся отраслевым стандартом для организации сетевого доступа к файловым системам.

## Ключевые архитектурные особенности NFSv3

:::::::::::::: {.columns align=top}
::: {.column width="50%"}

Основа протокола — **stateless-архитектура,** где сервер не сохраняет состояние клиента между запросами. Это обеспечивает простоту реализации и отказоустойчивость — при перезагрузке сервера клиенты могут продолжить работу без потери сессии. Однако такая модель требует использования дополнительных служб: rpc.mountd для монтирования, rpc.statd и rpc.lockd для управления блокировками файлов.

:::
::: {.column width="50%"}

![](image/state.png){width="110%"}

:::
:::::::::::::

## Принцип работы NFSv3

![](image/nfsv3.png){width="105%"}

# Протокол NFSv4

## Протокол NFSv4

**NFSv4,** разработанный в 2000 году, представляет собой фундаментальную переработку протокола, устранившую многие ограничения предыдущих версий и предложившую комплексное решение для современных распределенных сред.

## Ключевые архитектурные особенности NFSv4

:::::::::::::: {.columns align=top}
::: {.column width="50%"}

Основное нововведение — переход на **stateful-архитектуру,** где сервер сохраняет состояние клиентских сессий, открытых файлов и блокировок. Это позволило повысить надежность операций и упростить модель программирования. Все компоненты, включая монтирование файловых систем и управление блокировками, были интегрированы в основной протокол, что устранило зависимость от внешних служб (mountd, lockd, statd).

:::
::: {.column width="50%"}

![](image/state.png){width="110%"}

:::
:::::::::::::

## Принцип работы NFSv4

:::::::::::::: {.columns align=top}
::: {.column width="10%"}


:::
::: {.column width="90%"}

![](image/nfsv4.png){width="85%"}

:::
:::::::::::::

# Практическое применение

## Практическое применение

:::::::::::::: {.columns align=top}
::: {.column width="50%"}

Чтобы посмотреть, как работают NFSv3 и NFSv4 в реальной жизни была развернута тестовая среда, состоящая из двух узлов:

- Хост-система под управлением Ubuntu, выполняющая роль NFS-клиента ([рис. @fig-001])
- Виртуальная машина (Ubuntu VM), функционирующая в качестве NFS-сервера ([рис. @fig-002])

:::
::: {.column width="50%"}

![IP-адрес клиента](image/1.png){#fig-001}

![IP-адрес сервера](image/2.png){#fig-002}

:::
:::::::::::::

## Практическое применение. Настройка СЕРВЕРА (Ubuntu VM)

:::::::::::::: {.columns align=top}
::: {.column width="50%"}

![Установка NFS-сервера](image/3.png){#fig-003}

![Создание тестовых каталогов](image/4.png){#fig-004}

:::
::: {.column width="50%"}

Установим NFS-сервер с помощью ```sudo apt install nfs-kernel-server -y``` ([рис. @fig-003])

И создадим тестовые каталоги: ```sudo mkdir -p /srv/nfs3 /srv/nfs4``` и ```sudo chown nobody:nogroup /srv/nfs3 /srv/nfs4``` ([рис. @fig-004])

:::
:::::::::::::

## Практическое применение. Настройка СЕРВЕРА (Ubuntu VM)

:::::::::::::: {.columns align=top}
::: {.column width="50%"}

Создадим тестовые файлы в этих каталогах: ```echo "Тестовый файл NFSv3" | sudo tee /srv/nfs3/test_file_v3.txt``` и ```echo "Тестовый файл NFSv4" | sudo tee /srv/nfs4/test_file_v4.txt``` ([рис. @fig-005])

Далее настроим экспорт. Для этого откроим файл */etc/exports* и пропишем настройки для обеих версий протокола ([рис. @fig-006])

:::
::: {.column width="50%"}

![Создание тестовых файлов](image/5.png){#fig-005}

![Настройка экспорта](image/6.png){#fig-006}

:::
:::::::::::::

## Практическое применение. Настройка СЕРВЕРА (Ubuntu VM)

:::::::::::::: {.columns align=top}
::: {.column width="50%"}

![Применение настроек экспорта](image/7.png){#fig-007}

![Запуск сервера](image/8.png){#fig-008}

![Список экспортированных каталогов](image/9.png){#fig-009}

:::
::: {.column width="50%"}

После сохранения файла применим настройки командой ```sudo exportfs -ra``` ([рис. @fig-007])

Запустим сервер с помощью ```sudo systemctl start nfs-server``` и ```sudo systemctl enable nfs-server``` ([рис. @fig-008])

Проверим список экспортированных каталогов с помощью ```sudo exportfs -v``` ([рис. @fig-009])

:::
:::::::::::::

## Практическое применение. Настройка КЛИЕНТА (Ubuntu Host)

:::::::::::::: {.columns align=top}
::: {.column width="50%"}

Установим NFS-клиент с помощью ```sudo apt install nfs-common -y``` ([рис. @fig-010])

Создадим точки монтирования: ```sudo mkdir -p /mnt/nfs3 /mnt/nfs4``` ([рис. @fig-011])

Проверим доступность NFS-сервера: ```showmount -e 192.168.56.103``` ([рис. @fig-012])

![Установка NFS-клиента](image/10.png){#fig-010}

:::
::: {.column width="50%"}

![Создание точек монтирования](image/11.png){#fig-011}

![Проверка доступности NFS-сервера](image/12.png){#fig-012}

:::
:::::::::::::

## Практическое применение. Настройка КЛИЕНТА (Ubuntu Host)

:::::::::::::: {.columns align=top}
::: {.column width="50%"}

![Монтирование NFSv3](image/13.png){#fig-013}

![Проверка каталога /mnt/nfs3](image/14.png){#fig-014}

![Создание файла с клиента в каталоге /mnt/nfs3](image/15.png){#fig-015}

:::
::: {.column width="50%"}

Выполним монтирование удалённой файловой системы с использованием протокола NFSv3 на клиенте: ```sudo mount -t nfs -o vers=3,nolock 192.168.56.103:/srv/nfs3 /mnt/nfs3``` ([рис. @fig-013])

Теперь файлы из серверного каталога /srv/nfs3 доступны в локальной папке /mnt/nfs3. Поверим это ([рис. @fig-014])

Создадим файл с клиента в каталоге */mnt/nfs3* ([рис. @fig-015])

:::
:::::::::::::

## Практическое применение. Настройка КЛИЕНТА (Ubuntu Host)

:::::::::::::: {.columns align=top}
::: {.column width="50%"}

Выполним монтирование удалённой файловой системы с использованием протокола NFSv4 на клиенте: ```sudo mount -t nfs -o vers=4 192.168.56.103:/srv/nfs4 /mnt/nfs4``` ([рис. @fig-016])

Теперь файлы из серверного каталога /srv/nfs4 доступны в локальной папке /mnt/nfs4. Поверим это ([рис. @fig-017])

Создадим файл с клиента в каталоге */mnt/nfs4* ([рис. @fig-018])

:::
::: {.column width="50%"}

![Монтирование NFSv4](image/16.png){#fig-016}

![Проверка каталога /mnt/nfs4](image/17.png){#fig-017}

![Создание файла с клиента в каталоге /mnt/nfs4](image/18.png){#fig-018}

:::
:::::::::::::

## Практическое применение. Анализ работы NFSv3 и NFSv4

:::::::::::::: {.columns align=top}
::: {.column width="50%"}

![Порты сервера](image/19.png){#fig-019}

![Информация о монтировании](image/20.png){#fig-020}

:::
::: {.column width="50%"}

На клиенте проверим порты сервера: ```rpcinfo -p 192.168.56.103 | grep -E "nfs|mount"``` ([рис. @fig-019])

Посмотрим информацию о монтировании: ```mount | grep nfs``` ([рис. @fig-020])

:::
:::::::::::::

## Практическое применение. Анализ работы NFSv3 и NFSv4

:::::::::::::: {.columns align=top}
::: {.column width="50%"}

На сервере проверим, что создались файлы созданные на клиенте ([рис. @fig-021]), ([рис. @fig-022])

![Проверка файлов на сервере (1)](image/21.png){#fig-021}

:::
::: {.column width="50%"}


![Проверка файлов на сервере (2)](image/22.png){#fig-022}

:::
:::::::::::::

## Сравнение NFSv3 и NFSv4

\begin{table}[H]
\centering
\footnotesize
\caption{Сравнение NFSv3 и NFSv4}
\label{table:table}
\begin{tabular}{|p{4cm}|p{5cm}|p{4cm}|}
\hline
\textbf{Параметр} & \textbf{NFSv3} & \textbf{NFSv4} \\ \hline
Архитектура & Stateless (без сохранения состояния) & Statefull (с сохранением состояния) \\ \hline
Протокол & TCP/UDP & Только TCP \\ \hline
Порты & Несколько портов (111, 2049+) & Единый порт 2049 \\ \hline
Блокировка файлов & Использует отдельный протокол & Встроена в основной протокол \\ \hline
Монтирование & Отдельный протокол (mountd) & Встроенное в протокол \\ \hline
Сложность настройки & Выше (несколько демонов) & Ниже (один демон) \\ \hline
Восстановение после сбоя & Клиенты должны переподключаться & Автоматическое восстановление \\ \hline
Совместимость & Широкая, работает с очень старыми системами & Требует поддержки NFSv4 на клиенте и сервере \\ \hline
\end{tabular}
\end{table}

# Вывод

## Вывод

Таким образом, сравнительный анализ NFSv3 и NFSv4 демонстрирует существенную эволюцию сетевых файловых систем. NFSv3 остается надежным решением для локальных сетей, где важны простота и минимальные задержки. Однако его ограничения в безопасности и работе с распределенными средами становятся все более критичными. А NFSv4 представляет собой качественно новый подход, предлагая комплексное решение современных задач. Для новых проектов NFSv4 является предпочтительным выбором благодаря своей надежности и безопасности, в то время как NFSv3 остается решением для сред, где производительность важнее функциональности.

## Список литературы

1. [Brent Callaghan, Brian Pawlowski, P.S. — NFS Version 3 Protocol Specification, 1995](https://www.rfc-editor.org/rfc/rfc1813.html)
2. [Chapter 8. Network File System (NFS). — Red Hat Documentation, 2023](https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/7/html/storage_administration_guide/ch-nfs)
3. [NFS. — itglobal.com, 2024](https://itglobal.com/ru-ru/company/glossary/nfs/)
4. [Stateful и Stateless - архитектуры – объяснение для новичков. — Meri-on, 2024](https://wiki.merionet.ru/articles/stateful-i-stateless-arxitektury-obieiasnenie-dlia-novickov)
5. [Настройка NFS в Ubuntu. — рег.облако, 2022](https://reg.cloud/support/cloud/oblachnyye-servery/ustanovka-programmnogo-obespecheniya/nastrojka-nfs-v-ubuntu?utm_source=google.com&utm_medium=organic&utm_campaign=reg.cloud&utm_referrer=google.com&utm_content=%2Fsupport%2Fcloud%2Foblachnyye-servery%2Fustanovka-programmnogo-obespecheniya%2Fnastrojka-nfs-v-ubuntu)
6. [Хемани Р. NFS: протокол с десятилетней историей работает на Web. — Сети, 1996](https://www.osp.ru/nets/1996/09/141976)

